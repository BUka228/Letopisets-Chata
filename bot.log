2025-04-23 10:17:55,369 - root [INFO] - Логирование в файл настроено: .\bot.log
2025-04-23 10:17:56,396 - __main__ [INFO] - Инициализация бота...
2025-04-23 10:17:56,397 - root [INFO] - Ключевые переменные окружения (токены) успешно загружены.
2025-04-23 10:17:56,397 - data_manager [INFO] - Инициализация хранилища данных (SQLite)...
2025-04-23 10:17:56,412 - data_manager [INFO] - Таблица 'messages' проверена/создана.
2025-04-23 10:17:56,413 - data_manager [INFO] - Индексы для таблицы 'messages' проверены/созданы.
2025-04-23 10:17:56,413 - data_manager [INFO] - База данных '.\bot_data.db' успешно инициализирована.
2025-04-23 10:17:56,414 - gemini_client [INFO] - Клиент Gemini API успешно сконфигурирован для модели 'gemini-1.5-flash-latest'.
2025-04-23 10:17:56,509 - __main__ [INFO] - Обработчики команд и сообщений зарегистрированы.
2025-04-23 10:17:56,516 - __main__ [INFO] - Ежедневная задача генерации историй запланирована на 00:05:00 UTC.
2025-04-23 10:17:56,516 - __main__ [INFO] - Настройка обработчиков сигналов остановки...
2025-04-23 10:17:56,517 - __main__ [INFO] - Настройка через signal.signal (Windows)...
2025-04-23 10:17:56,517 - __main__ [INFO] - Запуск бота...
2025-04-23 10:17:56,905 - __main__ [INFO] - Бот LetopisetsChatBot (ID: 7995921431) успешно запущен.
2025-04-23 10:17:56,977 - telegram.ext.Application [INFO] - Application started
2025-04-23 10:18:06,035 - __main__ [WARNING] - Получен сигнал остановки SIGINT (2). Завершаю работу...
2025-04-23 10:18:06,035 - __main__ [INFO] - Запускаю штатную остановку Telegram Bot Application...
2025-04-23 10:18:06,036 - asyncio [ERROR] - Task exception was never retrieved
future: <Task finished name='Task-13' coro=<shutdown_signal_handler() done, defined at A:\Progects\DL\main.py:49> exception=RuntimeError('This Application is still running!')>
Traceback (most recent call last):
  File "A:\Progects\DL\main.py", line 57, in shutdown_signal_handler
    await asyncio.create_task(application.shutdown(), name="PTB Shutdown")
  File "C:\Python311\Lib\site-packages\telegram\ext\_application.py", line 534, in shutdown
    raise RuntimeError("This Application is still running!")
RuntimeError: This Application is still running!
